<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Forest Game with Improved Visuals</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            display: block;
            background: url('forest.JPG') no-repeat center center;
            background-size: cover;
        }
        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 24px;
            color: white;
            font-family: Arial, sans-serif;
        }
        #highScore {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            color: white;
            font-family: Arial, sans-serif;
        }
        #lives {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: white;
            font-family: Arial, sans-serif;
        }
        #timer {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            color: white;
            font-family: Arial, sans-serif;
        }
        #menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-family: Arial, sans-serif;
            color: white;
        }
        #menu button {
            font-size: 20px;
            padding: 10px 20px;
            margin: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1>Forest Adventure Game</h1>
        <button onclick="startGame()">Start Game</button>
    </div>
    <div id="score" style="display: none;">Score: 0</div>
    <div id="highScore" style="display: none;">High Score: 0</div>
    <div id="lives" style="display: none;">Lives: 3</div>
    <div id="timer" style="display: none;">Time Left: 60s</div>
    <canvas id="gameCanvas" style="display: none;"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('highScore');
        const livesElement = document.getElementById('lives');
        const timerElement = document.getElementById('timer');
        const menu = document.getElementById('menu');

        // Load sound effects
        const jumpSound = new Audio('jump.mp3');
        const collectibleSound = new Audio('collect.mp3');
        const gameOverSound = new Audio('gameover.mp3');
        const powerUpSound = new Audio('powerup.mp3');
        const backgroundMusic = new Audio('background.mp3');
        backgroundMusic.loop = true;
        backgroundMusic.volume = 0.5;

        let gamePaused = false;
        let score = 0;
        let lives = 3;
        let timeLeft = 60; // Time limit for each challenge (in seconds)
        let highScore = localStorage.getItem('highScore') ? parseInt(localStorage.getItem('highScore')) : 0;
        highScoreElement.textContent = `High Score: ${highScore}`;

        // Set canvas dimensions to match the window size
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        // Load images for obstacles, collectibles, power-ups, and player sprite sheet
        const obstacleImage = new Image();
        obstacleImage.src = 'obstacle.png';
        const collectibleImage = new Image();
        collectibleImage.src = 'collectible.png';
        const powerUpSpeedImage = new Image();
        powerUpSpeedImage.src = 'powerup_speed.png';
        const powerUpShieldImage = new Image();
        powerUpShieldImage.src = 'powerup_shield.png';
        const playerSprite = new Image();
        playerSprite.src = 'player_sprite.png';

        // Background layers for parallax scrolling
        const backgroundLayers = [
            {
                image: new Image(),
                x: 0,
                speed: 0.5
            },
            {
                image: new Image(),
                x: 0,
                speed: 1
            }
        ];
        backgroundLayers[0].image.src = 'forest.JPG';
        backgroundLayers[1].image.src = 'forest_layer2.JPG';

        // Player object representing the animated character
        let player = {
            x: 100, // Initial x position of the player
            y: canvas.height - 150, // Initial y position of the player (bottom of the screen)
            width: 50, // Width of the player
            height: 50, // Height of the player
            speed: 5, // Speed at which the player moves
            dx: 0, // Change in x position (movement direction)
            dy: 0, // Change in y position
            gravity: 1, // Gravity affecting the player
            jumpStrength: -15, // Strength of the jump
            onGround: true, // Check if the player is on the ground
            shielded: false, // Indicates if the player is shielded
            frame: 0, // Animation frame
            frameCount: 0, // Frame count for animation speed control
            spriteWidth: 48, // Width of a single frame in the sprite sheet
            spriteHeight: 48 // Height of a single frame in the sprite sheet
        };

        let collectibles = [];
        let obstacles = [];
        let powerUps = [];

        // Function to create an obstacle
        function createObstacle() {
            const size = Math.random() * 50 + 20; // Random size between 20 and 70
            const obstacle = {
                x: canvas.width, // Start at the right edge of the canvas
                y: Math.random() * (canvas.height - size - 100), // Random vertical position
                width: size,
                height: size,
                speed: Math.random() * 2 + 2, // Random speed between 2 and 4
                moving: Math.random() < 0.5 // Randomly decide if the obstacle should move vertically
            };
            obstacles.push(obstacle);
        }

        // Function to create a collectible
        function createCollectible() {
            const size = 20;
            const collectible = {
                x: Math.random() * (canvas.width - size), // Random horizontal position
                y: Math.random() * (canvas.height - size - 100), // Random vertical position
                width: size,
                height: size
            };
            collectibles.push(collectible);
        }

        // Function to create a power-up
        function createPowerUp() {
            const size = 30;
            const type = Math.random() < 0.5 ? 'speed' : 'shield'; // Randomly choose between speed boost or shield
            const powerUp = {
                x: Math.random() * (canvas.width - size),
                y: Math.random() * (canvas.height - size - 100),
                width: size,
                height: size,
                type: type
            };
            powerUps.push(powerUp);
        }

        // Function to draw the player on the canvas
        function drawPlayer() {
            // Draw player using sprite sheet
            ctx.drawImage(
                playerSprite,
                player.frame * player.spriteWidth, // Source x position
                0, // Source y position
                player.spriteWidth, // Source width
                player.spriteHeight, // Source height
                player.x, // Destination x position
                player.y, // Destination y position
                player.width, // Destination width
                player.height // Destination height
            );

            // Update animation frame
            player.frameCount++;
            if (player.frameCount % 10 === 0) {
                player.frame = (player.frame + 1) % 4; // Loop through 4 frames
            }
        }

        // Function to draw the background layers for parallax scrolling
        function drawBackground() {
            backgroundLayers.for
